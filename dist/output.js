function p(t){if(!t.length)return document.createTextNode("");let e=document.createElement("table"),o=document.createElement("thead"),n=document.createElement("tbody"),d=document.createElement("tr");return Object.keys(t[0]).forEach(s=>{let i=document.createElement("th");i.textContent=s,d.appendChild(i)}),o.appendChild(d),t.forEach(s=>{let i=document.createElement("tr");Object.values(s).forEach(f=>{let u=document.createElement("td");u.textContent=f,i.appendChild(u)}),n.appendChild(i)}),e.appendChild(o),e.appendChild(n),e}var h={asTable:p};var c="---";function x(t,e){let o=t.indexOf(e);return o>=0?[t.slice(0,o),t.slice(o+e.length)]:[t,""]}function g(t){if(t.endsWith(c))return"";let e=t.lastIndexOf(`
${c}
`);return e!==-1?t.slice(e+c.length+2):t.startsWith(c)?t.slice(c.length+1):t}var m={cut:x,tail:g,HORIZONTAL_RULE:c};var r={text:"text",table:"table",svg:"svg",html:"html",iframe:"iframe",dom:"dom",hidden:"hidden"},b="ok",l=document.createElement("template");l.innerHTML=`
<a href="#close">\u2715</a>
<pre><code></code></pre>
`;var E={[r.text]:(t,e)=>{let o=t.stdout||t.stderr,n=e?m.tail(o):o;return document.createTextNode(n||b)},[r.table]:t=>{if(!t.stdout)return document.createTextNode(t.stderr);let e=typeof t.stdout=="object"?t.stdout:JSON.parse(t.stdout);return h.asTable(e)},[r.svg]:t=>{if(!t.stdout)return document.createTextNode(t.stderr);let e=new DOMParser().parseFromString(t.stdout,"image/svg+xml");return e.querySelector("parsererror")?document.createTextNode(t.stdout):e.documentElement},[r.html]:t=>{if(!t.stdout)return document.createTextNode(t.stderr);let e=new DOMParser().parseFromString(t.stdout,"text/html");if(e.querySelector("parsererror"))return document.createTextNode(t.stdout);let o=document.createDocumentFragment();return Array.from(e.body.childNodes).forEach(n=>o.appendChild(n)),o},[r.iframe]:t=>{if(!t.stdout)return document.createTextNode(t.stderr);let e=new DOMParser().parseFromString(t.stdout,"text/html");if(e.querySelector("parsererror"))return document.createTextNode(t.stdout);let o=document.createElement("iframe");return o.width="100%",o.srcdoc=e.documentElement.outerHTML,o.onload=()=>{let n=o.contentDocument.body,d=o.contentDocument.documentElement,s=Math.max(n.scrollHeight,n.offsetHeight,d.clientHeight,d.scrollHeight,d.offsetHeight);o.style.height=s+"px"},o},[r.dom]:t=>t.stdout?t.stdout:document.createTextNode(t.stderr),[r.hidden]:t=>!t.stdout&&t.stderr?document.createTextNode(t.stderr):null},a=class extends HTMLElement{constructor(){super()}connectedCallback(){this.ready||(this.appendChild(l.content.cloneNode(!0)),this.close=this.querySelector("a"),this.output=this.querySelector("pre > code"),this.close.addEventListener("click",e=>{e.preventDefault(),this.hide()}),this.ready=!0)}fadeOut(){this.style.opacity=.4}fadeIn(){setTimeout(()=>{this.style.opacity=""},100)}showResult(e){let o=E[this.mode](e,this.tail);if(this.output.innerHTML="",!o){this.hide();return}this.output.appendChild(o),this.show()}showMessage(e){this.output.innerText=e,e?this.show():this.hide()}showError(e){let o=e.message+(e.stack?`
${e.stack}`:"");this.showMessage(o)}show(){this.removeAttribute("hidden")}hide(){this.setAttribute("hidden","")}get mode(){return this.getAttribute("mode")||r.text}set mode(e){e in r||(e=r.text),this.setAttribute("mode",e)}get tail(){return this.hasAttribute("tail")}set tail(e){e?this.setAttribute("tail",""):this.removeAttribute("tail")}};window.customElements.get("codapi-output")||customElements.define("codapi-output",a);export{a as CodapiOutput};
